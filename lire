#!/usr/bin/env python3

import argparse
import ebooklib
from ebooklib import epub
from bs4 import BeautifulSoup
import curses
import os

def extract_text_by_chapter(book):
    chapters = []
    for item in book.get_items_of_type(ebooklib.ITEM_DOCUMENT):
        content = item.get_body_content()
        soup = BeautifulSoup(content, 'html.parser')
        chapter_text = soup.get_text()
        chapters.append(chapter_text)
    return chapters

def main():
    parser = argparse.ArgumentParser(description='EPUB TUI Reader.')
    parser.add_argument('input_path', type=str, help='Path to EPUB file')
    parser.add_argument('-o', '--output', type=str, help='Output directory for chapter text files')
    args = parser.parse_args()
    book = epub.read_epub(args.input_path)
    chapters = extract_text_by_chapter(book)

    def curses_main(stdscr):
        display_chapters(stdscr, chapters)
    curses.wrapper(curses_main)

if __name__ == "__main__":
    main()
